<md-toolbar class="flow-top-bar">
  <div class="md-toolbar-tools">
    <md-button ng-click="toggleNav()" class="menu-icon flow-top-bar-tool flow-top-bar-tool--menu-button" aria-label="Open Menu">
      <i class="fa fa-bars" ng-hide="isNavLockedOpen()"></i>
    </md-button>

    <flow-editor-omnibox class="flow-top-bar-tool flow-top-bar-tool--omni-search" omni-search="omniSearch" flow-nodes="activeFlow.nodes" selected-flow-node="activeFlow.selectedFlowNode" ></flow-editor-omnibox>

    <div class="flow-top-bar-tool flow-top-bar-tool--flow-search">
      <div class="input-group flow-name dropdown" dropdown is-open="flowDropDownIsOpen">
        <input type="text" class="form-control" placeholder="Flow Name" ng-model="activeFlow.name" style="border-right: 0px;">
        <ul class="dropdown-menu" role="menu" aria-labelledby="flowMenuDropdown" style="max-height: {{flowSelectorHeight}}px;">
          <li class="text-center" data-toggle="dropdown" ng-click="addFlow()"><a class="fa fa-plus" href></a></li>
          <li role="presentation"  class="divider"></li>
          <li class="flow-item" data-toggle="dropdown" ng-repeat="flow in flows | orderBy: 'name'" >
            <a ui-sref="material.flow({flowId: flow.flowId})"><i class="fa fa-fw fa-power-off" ng-class="{'online' : flow.online}"></i> {{flow.name}}</a>
          </li>
        </ul>
        <span class="input-group-addon flow-dropdown" id="flowMenuDropdown" style="border-left: 0px;">
          <button class="flow-search--button" ng-click="toggleDropdown($event)">
            <i class="fa fa-lg fa-angle-down input-addon"></i>
          </button>
        </span>
      </div>
    </div>

    <div class="flow-controls flow-top-bar-tool flow-top-bar-tool--controls" >
      <md-button ng-click="deleteFlow(activeFlow)" data-action="delete-flow" aria-label="Delete Flow">
        <md-tooltip>Delete Flow</md-tooltip>
        <i class="fa fa-lg fa-trash"></i>
      </md-button>

      <md-button ng-click="createBluprint(activeFlow)" aria-label="Create Bluprint">
        <md-tooltip>Create a Bluprint</md-tooltip>
        <i class="fa fa-lg fa-share-alt"></i>
      </md-button>

      <md-button ng-click="undoEdit()" ng-disabled="!undoable()" aria-label="Undo Edit">
        <md-tooltip>Undo</md-tooltip>
        <i class="fa fa-reply fa-lg"></i>
      </md-button>

      <md-button ng-click="redoEdit()" ng-disabled="!redoable()" aria-label="Redo Edit">
        <md-tooltip>Redo</md-tooltip>
        <i class="fa fa-mail-forward fa-lg"></i>
      </md-button>

      <span ng-if="deployProgress !== 0">
        <md-button aria-label="Progress" style="width: 75px;">
          <md-tooltip>Progress</md-tooltip>
          {{deployProgress}}%
        </md-button>
        <md-progress-linear class="md-accent" md-mode="buffer" value="{{deployProgress}}"></md-progress-linear>
      </span>
      <span ng-if="deployProgress === 0">
        <md-button ng-click="stop()" class="stop-button" ng-class="{ 'btn-stopped': deviceOnline === false}" aria-label="Stop">
          <md-tooltip>Stop</md-tooltip>
          <i class="fa fa-stop"></i>
        </md-button>

        <md-button ng-click="start()" class="start-button" ng-class="{ 'btn-playing': deviceOnline, 'needs-to-be-deployed': needsToBeDeployed }" aria-label="Start">
          <md-tooltip>Start</md-tooltip>
          <i class="fa fa-play"></i>
        </md-button>
      </span>
    </div>
  </div>
</md-toolbar>

<div class="design2 designer-container"
  tutorial
  drop="onDrop($data, $event)"
  drop-effect="copy"
  drop-accept="'json/custom-object'"
  drag-over="onDragOver($event)"
  drag-over-class="drag-over-accept">

  <flow-editor ng-class="{'flow-online' : deviceOnline }" flow="activeFlow" w-mousetrap="{'mod+c':copySelection, 'mod+x': cutSelection, 'mod+v':pasteSelection, 'backspace': deleteSelection, 'del': deleteSelection, 'mod+z':undoEdit, 'mod+y':redoEdit}" ng-mousemove="setMousePosition($event)" ng-mouseout="clearMousePosition()"></flow-editor>

  <img src="/assets/images/octoblu.png" class="designer__octoblu-logo"/>

  <div class="designer__zoom-controls" ng-class="{'designer__zoom-controls-closed' : !sidebarIsExpanded}">
    <div class="designer__zoom-control-group">
      <md-button class="designer__zoom-control-button" ng-click="center()" aria-label="Center">
        <i class="fa fa-crosshairs fa-lg"></i>
      </md-button>
    </div>

    <div class="designer__zoom-control-group">
      <md-button class="designer__zoom-control-button" ng-click="zoomIn()" w-mousetrap="{'+' : zoomIn, '=' : zoomIn}" aria-label="Zoom In">
        <i class="fa fa-plus fa-lg"></i>
      </md-button>

      <hr class="designer__zoom-control-hr">

      <md-button class="designer__zoom-control-button" ng-click="zoomOut()" w-mousetrap="{'-' : zoomOut, '_' : zoomOut}" aria-label="Zoom Out">
        <i class="fa fa-minus fa-lg"></i>
      </md-button>
    </div>
  </div>
  <button class="sidebar__expand-button sidebar__toolbar-button" ng-class="{'sidebar__expand-button--closed': !sidebarIsExpanded}" ng-click="toggleSidebarView()">
    <i ng-show="!sidebarIsExpanded" class="fa fa-chevron-left"></i>
    <i ng-show="sidebarIsExpanded" class="fa fa-chevron-right"></i>
  </button>
  <div ng-class="{'sidebar--is-expanded': sidebarIsExpanded}" class="sidebar">
    <flow-inspector flow="activeFlow"></flow-inspector>
    <collection-browser flow="activeFlow"></collection-browser>
  </div>
</div>

<style ng-if="sidebarIsExpanded">
  html body #intercom-container .intercom-launcher {
    bottom: 20px;
    right: 476px;
    -webkit-transition: all 0.2s;
            transition: all 0.2s;
  }
</style>
<style ng-if="!sidebarIsExpanded">
  html body #intercom-container .intercom-launcher {
    bottom: 20px;
    right: 76px;
    -webkit-transition: all 0.2s;
            transition: all 0.2s;
  }
</style>
